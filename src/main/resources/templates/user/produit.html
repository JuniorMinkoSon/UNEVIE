<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />

<script>
    tailwind.config = {
        theme: {
            extend: {
                colors: {
                    premium: {
                        orange: '#f97316',
                        dark: '#1a1a1a',
                        light: '#fdfcfb',
                        accent: '#fbbf24'
                    }
                },
                fontFamily: {
                    sans: ['Outfit', 'sans-serif'],
                }
            }
        }
    }
</script>
</head>

<body class="bg-premium-light text-premium-dark font-sans flex flex-col min-h-screen">

    <div th:replace="~{fragments/header :: header}"></div>

    <!-- ✅ Zone d’alerte -->
    <div id="alert-container" class="fixed top-24 left-1/2 -translate-x-1/2 z-[100] w-full max-w-lg px-6"></div>

    <main class="flex-grow pt-32 pb-24">
        <section class="max-w-7xl mx-auto px-6 space-y-12">
            <div class="text-center space-y-4">
                <div
                    class="inline-block px-4 py-1.5 rounded-full bg-premium-orange/10 border border-premium-orange/20 text-premium-orange text-xs font-bold uppercase tracking-widest leading-none">
                    Catalogue</div>
                <h1 class="text-4xl md:text-5xl font-extrabold tracking-tight">Nos Produits Disponibles</h1>
                <p class="text-premium-dark/40 text-lg max-w-2xl mx-auto">Sélectionnés pour leur qualité et leur
                    fiabilité, découvrez une gamme de produits adaptés à vos besoins.</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10">
                <div th:each="p : ${produits}"
                    class="group bg-white rounded-[2.5rem] overflow-hidden border border-premium-dark/5 shadow-sm hover:shadow-2xl transition-all duration-500 flex flex-col">
                    <div class="relative h-64 overflow-hidden">
                        <img th:src="@{'/uploads/' + ${p.imageUrl}}"
                            class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700"
                            alt="Produit">
                        <div
                            class="absolute inset-0 bg-gradient-to-t from-premium-dark/40 to-transparent opacity-0 group-hover:opacity-100 transition-opacity">
                        </div>
                        <div class="absolute top-6 right-6 px-4 py-2 bg-white/90 backdrop-blur-md rounded-xl text-premium-dark font-bold text-xs shadow-xl"
                            th:text="${p.categorie}">Catégorie</div>
                    </div>

                    <div class="p-8 space-y-4 flex-grow flex flex-col justify-between">
                        <div class="space-y-2">
                            <h3 class="text-2xl font-bold group-hover:text-premium-orange transition-colors"
                                th:text="${p.nom}">Nom du produit</h3>
                            <p class="text-premium-dark/40 text-sm leading-relaxed line-clamp-2"
                                th:text="${p.description}"></p>
                        </div>

                        <div class="pt-6 border-t border-premium-dark/5 flex items-center justify-between">
                            <div class="space-y-1">
                                <p class="text-[10px] font-bold text-premium-dark/30 uppercase tracking-widest pl-1">
                                    Prix</p>
                                <p class="text-2xl font-extrabold text-premium-orange"
                                    th:text="${#numbers.formatDecimal(p.prix, 0, 'COMMA', 0, 'POINT') + ' FCFA'}"></p>
                            </div>
                            <a th:href="@{'/commande/' + ${p.id}}"
                                class="bg-premium-dark text-white font-bold px-6 py-4 rounded-2xl hover:bg-premium-orange transition-all active:scale-95 shadow-lg group-hover:shadow-premium-orange/20">
                                Commander
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <div th:replace="~{fragments/footer :: footer}"></div>

    <!-- ✅ UI Script -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const params = new URLSearchParams(window.location.search);
            const alertContainer = document.getElementById('alert-container');

            if (params.get("success") === "commande") {
                const alert = document.createElement('div');
                alert.className = "bg-green-500 text-white p-6 rounded-3xl shadow-2xl flex items-center gap-6 animate-fade-in-up border-4 border-white/20";
                alert.innerHTML = `
                    <div class="w-12 h-12 bg-white/20 rounded-2xl flex items-center justify-center shrink-0">
                        <i class="fas fa-check text-xl"></i>
                    </div>
                    <div>
                        <p class="font-bold text-lg leading-none mb-1">Commande réussie !</p>
                        <p class="text-white/80 text-sm">Un responsable vous contactera sous peu pour finaliser la livraison.</p>
                    </div>
                    <button class="ml-auto w-10 h-10 hover:bg-white/10 rounded-xl transition-colors">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                alertContainer.appendChild(alert);

                // Handling close button
                alert.querySelector('button').addEventListener('click', () => {
                    alert.classList.add('opacity-0', '-translate-y-4');
                    setTimeout(() => alert.remove(), 500);
                });

                // Clear URL
                if (window.history.replaceState) {
                    const cleanUrl = window.location.protocol + "//" + window.location.host + window.location.pathname;
                    window.history.replaceState({}, document.title, cleanUrl);
                }

                // Auto-hide
                setTimeout(() => {
                    if (alert.parentNode) {
                        alert.classList.add('opacity-0', '-translate-y-4');
                        setTimeout(() => alert.remove(), 500);
                    }
                }, 8000);
            }
        });
    </script>

    <style>
        @keyframes fade-in-up {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fade-in-up {
            animation: fade-in-up 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }
    </style>
</body>

</body>

</html>